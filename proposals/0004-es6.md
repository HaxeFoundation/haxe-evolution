# ES6

* Proposal: [HXP-0004](0004-es6.md)
* Author: [Joshua Granick](https://github.com/openfl)

## Introduction

ES6 support for JavaScript in the compiler

## Motivation

JavaScript is getting newer, and better.

Generating classes for ES6 would allow for highly improved integration with
ES6 source, TypeScript and most modern JavaScript workflows. Also, all major
browsers support ES6 sources out-of-the-box. This improves debugging, and
ultimately improves the quality of Haxe's JavaScript.

It's time to move the next generation. Modular JavaScript would benefit highly
from ES6 JavaScript output. This allows for intelligent bundling, and integration
with a wide-range of enterprise JavaScript tooling.

ES6 support in the compiler would allow for cleaner, faster more accurate output.

## Detailed design

The older `-D js-es5` flag was introduced as an option, then made the default later.

Introduce a new `-D js-es6` flag, which generates multiple ES6 output files, similar
to targets like C++ that use a directory rather than a file name. Optionally, the
output could include the name for the entry class, but the rest would be named 
based on their names.

Each ES class file can contain multiple definitions. Hidden "impl" types and other
generated code would go under the original module that generated it. For example, 
"com.mycode._MyAbstract.MyAbstract_Impl" would be generated within "com.mycode.MyAbstract"
with a "MyAbstract_Impl" default export. Class and enum output is more straightforward.

These are some samples:

```haxe
package;

import test.BaseClass;

class MyClass extends BaseClass {
	
	public function new () {
		
		super ();
		
	}
	
}
```

```js
import BaseClass from "test/BaseClass";

class MyClass extends BaseClass {
	
	constructor () {
		
		super ();
		
	}
	
}

export default MyClass;
```

```haxe
package;

enum MyEnum {
	
	A;
	B;
	C;
	
}
```

```js
const MyEnum = {
	
	A: Symbol (),
	B: Symbol (),
	C: Symbol ()
	
};

export default MyEnum;
```

## Impact on existing code

This will not impact existing code that lacks the `-D js-es6` define.

Code that migrates will still include the same entry point, but will require either
a browser with support for ES6 imports, or post-processing with JavaScript tooling,
which enables many additional features, like bundling, minification and many other
steps essential to launching to production.

## Drawbacks

Adding ES6 output would require new effort in genjs

## Alternatives

Using a macro would be an alternative, but the output would be faster, cleaner and more 
accurate from the compiler.

## Opening possibilities

OpenFL, Actuate and Starling are currently written in Haxe, then deployed to NPM for
use from TypeScript, JavaScript or Haxe. This has required significant effort to accomplish,
but adding ES6 to Haxe's standard output would make these kind of use cases readily available
by default.

## Unresolved questions

